<!DOCTYPE html>
<html lang="zh-HK">

<head>
  <meta charset="utf-8" />
  <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="description" content="Chinese Ancient Calendar Generator 中國古曆編製器" />
  <link rel="apple-touch-icon" href="%PUBLIC_URL%/apple-touch-icon.png" />
  <!--
      manifest.json provides metadata used when your web app is installed on a
      user's mobile device or desktop. See https://developers.google.com/web/fundamentals/web-app-manifest/
    -->
  <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
  <title>赫赫曆藏</title>
</head>

<body>
  <section class='cover'>
    <h1>赫赫曆藏</h1>
    <h2 style="color:gray;font-weight:normal;letter-spacing:3px;margin-top:1em">中國古曆編製器 </h2>
  </section>
  <section class='content'>
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root"></div>
    <hr>
    <article>
      <h2 id="-">本工具簡介</h2>
      <ol>
        <li>目前的古代朔閏査詢網站都是根據工具書、文獻材料手動調整的<n>參考中研院 <a
              href="https://sinocal.sinica.edu.tw/lusodoc.html">兩千年中西曆轉換說明書</a>，廖育棟 <a
              href="https://ytliu0.github.io/ChineseCalendar/computation_chinese.html">本網站的農曆編算</a></n>。本工具可提供古代實行未實行的
          60 餘部曆法的朔望氣閏計算，完全遵照各曆算法進行全自動計算，無手動干預。這有如下獨特之處：<ol>
            <li>提供每年的積年、閏餘、每日的確切時刻</li>
            <li>定朔時刻日月所在赤道度、定氣時刻日所在赤道度<n>20210226v2.02</n>
            </li>
            <li>漢魏晉南北朝的交食計算<n>0302v2.05</n>
            </li>
          </ol>
        </li>
        <li>本工具完全開源，如您需要査詢、核査各曆的詳細參數與算法，請前往 源碼倉庫<n>內測階段暫不開放</n>。如您不嫌麻煩，可以下載源碼，在本地運行程序。如您不想每次都在線查詢，可下載
          離線打包文件，直接通過瀏覽器打開卽可。</li>
        <li>
          如您發現任何問題，可通過評論框或郵件向我反饋。本程序目前未經過文獻檢驗，我也暫時沒有機會把歷代的材料全部梳理一遍。若您在研究過程中發現程序結果與文獻不符，望不吝提供線索。這個工具是根據研究需要而開發的，如果您有任何功能需求，敬請與我聯繫，我會在力所能及的範圍內儘量實現。更多信息見頁腳。
        </li>
        <li>各時期曆法的行用情況見 <a href="https://kqh.me/tutorial/calendar4/">赫赫金鑰｜中國古代曆法史</a>。</li>
        <li>
          編程理念：以研究需求爲中心；設計理念：以用戶體驗爲中心，傻瓜式操作。關於表格的設計：採用加粗—正常——淺灰三層結構，用戶一眼就看到了定朔、平朔、平氣的干支，第二眼看到的是小分，最後如果要看公曆日期和節氣名字的話，纔會去看最不起眼的灰色。不同分類採用橫線隔開，並且有兩種粗細。同一分類就沒有線，避免視線錯亂。定朔平朔之間、定氣平氣之閒用細線，朔望氣之間用粗線。數字都用的等寬字體。每欄中間不設線，間隔恰到好處，不會太寬，讓視線跳躍得很累，也不會太緊，不易分辨。
        </li>
        <li>計算程序採用 JavaScript 編寫，採用滾動數組，減少近一半的計算時間。前端框架採用 React，採用 Web Worker 將 UI 線程與計算線程分離，採用懶加載，大幅壓縮渲染時間。更多技術特徵見
          README。【隱私聲明】本站使用了 Google Analytics 進行流量分析；評論系統採用 Hyvor Talk；服務器託管在 Netlify 平臺。運算均在本地進行。</li>
      </ol>
      <h2 id="-">凡例</h2>
      <h3 id="1-">1、朔望氣閏食</h3>
      <ol>
        <li>第一行爲整年的情況，例如「積2759228 天紀己卯蔀49 大51小747 冬至12.5 閏餘6842閏11」的意思是：此年上元積年爲 2759228 年，入天紀己卯蔀 49 年，天正月大餘 51、小餘
          747，冬至日數 12.5，閏餘 0.6842，按照閏餘法，11 月爲閏月。大餘加上蔀或紀名干支卽爲天正朔干支，如上例，己卯 16 + 大餘 51 = 67，mod (67, 60) = 7，正月朔爲庚午。四分曆日法爲
          940，小餘 747 轉換爲十進制就是 747 / 940 ≒ 0.7947。冬至 12.5 同樣需要加上蔀干支。閏餘爲十進制，若以章法19爲單位，就是0.6842×19=13。</li>
        <li>劉歆<v>世經</v>論<v>三統</v>上元積年多爲算外，但也有用算上的；<v>殷曆</v>
          <v>周曆</v>等古四分曆，歷代學者論上元積年多用算上，但也有用算外的。統一起見，本表各曆上元積年均爲算外，入蔀<n>統</n>年均爲算上。
        </li>
        <li>由於我暫時想不明白的原因，朔干支轉換成公曆日期的功能<n>該算法移植自廖育棟</n>，一年中可能有一個月有1天誤差<n>如甲子應該是2月2日，顯示的是2月1日</n>，並且有可能一整年會前後錯開一個月<n>
            如正月朔對應的是二月的公曆日期</n>。本工具提供的公曆日期僅供參考，如需使用公曆日期，請使用廖育棟的 <a
            href="https://ytliu0.github.io/ChineseCalendar/Julian_chinese.html">儒略日數和日干支計算器</a> 進行覆核。</li>
        <li>置閏共有三種方法：閏餘法、無中氣法、固定冬至法，閏餘法可分爲年中置閏、年末置閏兩種，無中氣法閏月必在年中<n>當然也可能在最後一個月</n>
          ，固定冬至法閏月必在年末。漢代以後均採用無中氣法。古六曆並不確定採用何種置閏法，本工具能同時顯示三種置閏法的結果<n>絕對獨家技術</n>
          ，以固定冬至法為主。第一行最後標注的是閏餘年中置閏法的閏月，若採用閏餘年末置閏法，最後一個月就是閏月。中氣一行採用無中氣置閏法，有「□□」的年份爲無中氣置閏法的閏年，「□□」表示該月無中氣，爲閏月。需要留意的是，若固定冬至法閏年在閏餘法、無中氣法的上一年，那麼該年的閏餘法、無中氣法閏月數需要加
          1
          ，因為固定冬至法把該年的第一個月往上年奪去了。固定冬至法的閏月必定置於年末；無中氣法的閏月可能比閏餘年中法提前或延後一個月：中氣與朔同在一日，中氣的時刻比朔早，則閏餘未達到閏準，還不能置閏；但是由於中氣與朔已經在一日了，上個月無中氣，需要置閏。
        </li>
        <li>判斷大小月的方法：看天干是否相同。如一、二、三月的朔分別是辛亥、辛巳、庚戌，辛亥、辛巳天干一樣，說明一月有 30 日，爲大月；辛巳、庚戌天干不同，說明二月有 29 日，爲小月。</li>
        <li>
          「平朔」卽未考慮日月速度變化而得出的朔日，「平氣」卽未考慮日速度變化而得出的中氣日，「定朔」卽加上日月速度改正而得出的朔日，「定氣」卽加上日速度改正而得出的中氣日。干支下的數字為小分，均為十進制小數，如「8184」卽0.8184，換算成24小時制爲：0.8184
          × 24 = 19.6416，0.6416 × 60 = 38.496，0.496 × 60 ≒ 30，卽19點38分30秒。小分到取小數點後四位，卽精度爲 8.64
          s。各曆均有不同的辰法，需要您手動進行轉換。未來我可能會加入辰法自動轉換。</li>
        <li>「二次」表示用二次差內插法計算出的小分，「一次」表示用線性內插法計算出的小分，「三次」表示用三次差公式計算出的小分。若某曆有二次差定朔計算，則望干支及小餘爲二次差定望，其餘曆法同理。</li>
        <li>雖然漢末<v>乾象曆</v>便出現了定朔推步，但直到唐初<v>麟德曆</v>纔正式開始用定朔編排曆書，此前都是平朔注曆，定朔僅用於交食推步。雖然隋劉焯<v>皇極曆</v>
          便發明了二次差計算定朔，但編排曆書時僅採用簡單的線性內插進行計算，二次差僅用於交食推步。雖然<v>皇極曆</v>開始便可以計算定氣，但直到淸<v>時憲曆</v>
          纔開始用定氣編排曆書，之前都是平氣注曆。本程序在平朔注曆時代用平朔編排閏月；在定朔推曆時代用二次差編排閏月、進朔，若遇一次差與二次差存在臨界差異，用戶大可進行手動調整，但這種極端情況應該不大可能出現。</li>
        <li>
          <v>元嘉</v>規定若月食發生在黎明之前，則屬上日，我把此規定用於所有的魏晉系曆法。干支減去1的，在定朔干支一格加上「-」，小分不變。<v>麟德</v>開始行進朔法，我目前暫時簡單將 0.75
          作爲進朔標準，進朔的月在干支後加上「+」來表示，僅將干支加 1，小分不變。如「乙丑+」表示原本的干支是甲子，進朔爲乙丑，而小分與進朔前一致。如果遇到與文獻不一致的情況，用戶可根據小分自行調整進朔與置閏。
        </li>
        <li>日食定在朔，月食定在望。「● ◐ ○」分別表示全食、偏食、虧蝕微少。乾象、大明沒有虧食程序的計算，大業以前沒有全食限，整齊起見，我一槪補齊。</li>
      </ol>
      <h3 id="2-">2、日書</h3>
      <p>【尚未完工】日書按月提供全年每一日的信息：</p>
      <ol>
        <li>第幾日、干支</li>
        <li>【日赤】日所在赤道度</li>
        <li>【日黃】日所在黃道度</li>
        <li>【日去極】日黃道去極度、日視赤緯。</li>
        <li>【晷長】以尺爲單位</li>
        <li>【日出】日出時刻。與朔閏表一樣，四位數前省略了「0.」，0.2500 卽 24 * 0.25 = 6 點</li>
        <li>【昏中星】太陽落山後約 2.5 刻的時候，正南的星宿。所謂「日短星昴」</li>
        <li>【月赤】月所在赤道度</li>
        <li>【黃白距】月與日的緯度差，日去極 + 黃白距 = 月去極。月在陽曆<n>黃道以南</n>爲正，月在陰曆<n>黃道以北</n>爲負</li>
        <li>【候土卦】發斂<n>七十二候</n>、土王用事、卦用事三個合在一起。</li>
      </ol>
      <p>
        【魁罡之月】切不得修造動土，大凶。【七曜對應】蜜=日，莫=月，雲漢=火，嘀=水，溫沒斯=木，那頡=金，雞緩=土【七曜値日吉凶】太陽直日，宜見官、出行、求財，走失必得，吉事重吉，凶事重凶；太陰直日，納財、治病、服藥、修井灶門戶，忌見官；火直日，宜買六畜、治病、合伙造書契、合市，忌針灸；水直日，宜入學造功德，一切工巧皆成，六畜走失自來；木直日，宜見官、禮事、買莊宅、下文狀、洗頭；金直日，宜受法、市口馬、著新衣、修門戶，忌見官；土直日，宜典莊田、市買牛馬，利加萬倍，修倉庫。【三元紫白詩】上利與功紫白方，碧綠之地患癰瘡，黃赤之方遭疾病，黑方動土主凶喪。【長短星】不宜市貿、交易、裁衣、納財【人神吉凶】人神所在及血忌血支不可鍼灸出血。【日遊吉凶】日遊在房內，產婦不宜於方位上安牀帳，及掃舍皆凶。（赵贞《敦煌具注历中的「蜜日」探研》、楊帥《出土文獻所見
        7-14
        世紀中國曆注研究》、鄧文寬《敦煌文獻S2620號唐年神方位圖試釋》。鄧文寬《敦煌古曆叢識》還有一部分歲神，以後補充。《敦煌曆日探研》，《出土文獻研究》第七輯）【黃道黑道】青龍黃道，天乙星；明堂黃道，貴人星；金匱黃道，福德星；天德黃道，寶光星；玉堂黃道，少微星，天開星；司命黃道，鳳輦星，月仙星；天刑黑道，天刑星；白虎黑道，天殺星；朱雀黑道，天訟星；天牢黑道，鎮神星；玄武黑道，天獄星；勾陳黑道，地獄星。（具體內容自己搜索）【往亡】不可起土功。分往亡、氣往亡兩類，爲示區分，我將第一類稱爲往亡，第二類稱爲氣亡。往亡=土忌、土禁、地杓、大徼、土司空。【復日】魁罡所擊之辰，忌爲凶事，利爲吉事。【重日】凶事重凶。【反支】反支日公車不受章奏，漢明帝「蠲其制」。流行於秦漢。推算方法仍有待研究。我暫且用
        554433221166【大時小時】頁 257【歸忌】忌遠行、歸家、移徙、娶婦【天李】=天理=天獄。不可入官、入室【臨日】=赤帝臨日，忌臨民、訴訟。（王強《出土戰國秦漢數術文獻神煞研究》）
      </p>

      <h3 id="3-">3、五星</h3>
      <p>預計 2023 年推出，敬請期待。</p>
      <h3 id="4-">4、轉換</h3>
      <p>此頁面提供了幾個轉換工具：</p>
      <h4 id="-">大衍求一術</h4>
      <p>輸入兩個 <b>互質</b> 的整數 a, b，求方程 <code>a * x ≡ 1 (mod b)</code> 的解 x 。可以 a&gt;b ，也可 a&lt;b 。更多內容可參考 <a
          href="https://zhuanlan.zhihu.com/p/272302805">中国剩余定理和大衍求一术</a>。</p>
      <h4 id="-">調日法與無窮調日法</h4>
      <p>一個朔望月是 29.5305 日有餘，在<v>授時</v>以前都用分數來表示朔分。自何承天始，以 彊子26 / 彊母47 爲彊率，以 弱子9 / 弱母17 爲弱率，則 朔餘 / 日法 可表示爲 (26m+9n) /
        (49m+17n) ，m 卽陽率<n>彊數</n>，n 卽陰率<n>弱數</n>，彊弱率之間的任何數都可以作如上表示。調日法是南系、隋系、唐系、宋系的不傳之祕，直到乾嘉時期李銳纔闡明此法<n>更多見 劉鈍<v>
            李銳、顧觀光調日法工作述評</v>，<v>自然科學史研究</v>1987(2)；陳久金<v>調日法研究</v>1984(3)；李繼閩<v>關於調日法的數學原理</v>，西北大學學報 1985(2)；<a
            href="https://kqh.me/tutorial/calendar4">赫赫金鑰</a></n>。</p>
      <p>無窮調日法是我自己的一點點小改進。彊弱率需滿足如下條件：<img src="https://pic.imgdb.cn/item/604db4765aedab222ce451f5.png" width="170">，卽
        <code>彊子 * 弱母 - 彊母 * 弱子 = 1</code> 。那麼推廣開來，26/47 和 9/17 只是一種可能性而已，適合求朔分 0.5305
        附近的數，而任何滿足這個條件的彊弱二率，都可以用來調制。只需要輸入分母<n>卽曆法中的日法</n>、彊率，便會自動根據大衍求一術求出弱率，再根據李銳公式求出分子<n>卽曆法中的朔餘</n>和彊弱數<n>卽加權</n>
        ；也可以同時輸入分子和分母，根據累彊弱之數、李銳、顧觀光-陳久金三種方法各自生成彊弱數。這推廣開來的調日法就是無窮調日法。輸入框中默認是何承天彊率。不過李銳公式有一個限制，必須滿足 弱數&lt;彊母，例如玄始曆 47251
        / 89052 ，李銳公式解得 47252 = 26×1816 + 9×4，累強弱、顧-陳公式解得 47251 = 26×1799 + 9×53，卽 47251 / 89052 和 47252 / 89052
        都滿足調日法，但李銳公式求不出前者。
      </p>
      <p>更多說明見 <a href="https://kqh.me/tutorial/calendar4">赫赫金鑰</a>。</p>
      <h4 id="-">連分數逼近</h4>
      <p>給定一個分數，求其最大公因數、連分數、各漸進連分數。連分數逼近非常適合與調日法參照。</p>
      <h4 id="-">儒略日與日期互轉</h4>
      <p>核心計算程序移植自 <a href="https://ytliu0.github.io/ChineseCalendar/Julian.js">廖育棟</a> 教授，表示感謝！我增加了毫秒計算，雖然沒什麼用。</p>
      <h4 id="-">黃赤轉換</h4>
      <p>黃道積度、赤道積度的相互轉換<n>如230度</n>。不用在意輸入的是黃道還是赤道，因為黃赤差都是一樣的，會自動生成黃道度和赤道度兩個結果，輸入的是黃道度，則選用生成的赤道度卽可，反之亦然。</p>
      <p>若想進行黃赤入宿度的相互轉換<n>如斗3度</n>，直接在日書進行線性內插卽可。</p>
      <h4 id="-">辰刻轉換</h4>
      <p>將萬分小數轉換爲辰數。</p>
    </article>
  </section>
  <section class="comment-wrap">
    <div class="comment">
      <p>—————————————如您發現任何問題，可通過評論框或郵件向我反饋—————————————</p>
      <div id="hyvor-talk-view"></div>
      <script type="text/javascript">
        var HYVOR_TALK_WEBSITE = 1727;
        var HYVOR_TALK_CONFIG = {
          url: 'https://cal.kqh.me',
          id: 'cal-kqh-me'
        };
      </script>
      <script async type="text/javascript" src="//talk.hyvor.com/web-api/embed"></script>
    </div>
  </section>
  <footer>
    <p><a href='https://kqh.me' target="_blank">柯棋瀚</a>©️ 2021-02-23 > 2021（內測期間請勿外傳）</p>
    <p>email&iMessage: me [at] kqh [dot] me</p>
    <p class='version'>程序v3.00 前端v1.00 更新日誌見 前端倉庫<n>內測期間暫不開放</n>proudly enhanced by <a
        href='https://mikemcl.github.io/decimal.js/' target="_blank">decimal.js</a>
    </p>
    <p>相關鏈接：<a href='https://ytliu0.github.io/ChineseCalendar/index_chinese.html'
        target='_blank'>廖育棟的網站</a>（年曆、氣朔時刻、中國歷史年表、儒略日干支轉換等）。廖育棟的<a
        href='https://ytliu.epizy.com/Shixian/index_chinese.html?i=1' target='_blank'>時憲曆計算</a>。<a
        href='https://kanasimi.github.io/CeJS/_test%20suite/era.htm' target='_blank'>紀年轉換工具</a>（世界各國曆法）。中研院 <a
        href='https://sinocal.sinica.edu.tw/'>兩千年中西曆轉換</a></p>
    <script async src="https://www.googletagmanager.com/gtag/js?id=UA-108451819-1"></script>
    <script>
      window.dataLayer = window.dataLayer || [];
      function gtag() { dataLayer.push(arguments); }
      gtag('js', new Date());
      gtag('config', 'UA-108451819-1');
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3.0.1/es5/tex-mml-chtml.js"></script>
    <!-- <script async src="%PUBLIC_URL%/nzh.min.js"></script> -->
  </footer>
</body>

</html>