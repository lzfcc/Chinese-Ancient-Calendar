## 垛積模塊說明

「垛積」卽等差級數求和。

### 隙積術　芻童垛

「芻童」卽長方稜臺。上有寬 a 個、長 b 個，下有寬 c 個、長 d 個，共 n 層，每層長寬各多 1 個。

<img src="https://pic.imgdb.cn/item/6095056cd1a9ae528f444d48.png" width='200'>

### 四角垛　方垛

卽自然數平方級數求和。`1+4+9+...+n^2 = 1/3 n (n+1) (n+1/2)=1/6 n (n+1) (2n+1)`

### 三角垛　落一形垛

源於七乘方圖。p = 2 時，`1+3+6+10+...+n (n+1) /2 = 1/6 n (n+1) (n+2)`。通項公式：`1/(p+1)! n (n+1) (n+2) ... (n+p)`

## 內插模塊說明

### 招差術

 **第一行輸入框** 在「數列」框中輸入一組離散値，數量 = 次數 + 1，以第一個數爲起算點。「次數」爲進行幾次內插，卽幾次多項式。n 爲所求的數，第一個離散値的 n 爲 1。內插公式的一般形式：f(x<sub>0</sub>+x) = f(x<sub>0</sub>) + Δ<sup>1</sup>x + Δ<sup>2</sup> 1/2! x (x-1) +...+ Δ<sup>p</sup> 1/p! x (x-1) ... (x-p+1)。初始値爲<v>大衍曆</v>晷影五次差分表

 **第二行輸入框** 已知差分<n>由低次到高次排列</n>，求 y(n)。次數爲差分的個數。第一個數的 n 是 0，上面的是 1。

一個 p 次多項式可表爲一個 p 次內插公式；以 p 次多項式爲通項的 p 階等差數列的和是一個 p+1 次多項式。招差術的實質是將高階等差數列的通項多項式表爲內插公式。招差的差系由給定的數列求得，內插的差系由數列的和函數求得。<n> 李兆華、程貞一<v>朱世傑招差術探原</v>，<v>自然科學史研究</v>2000(1)。</n>招差術與牛頓內插等價。

### 拉格朗日內插

數列中依次輸入各組 x, y 値。拉格朗日不等間距內插公式：y = Σ(n,1) yiLi, Li = Π(n,j=1,j≠i) (x-xj)/(xi-xj)。<v>大衍</v>不等間距內插公式應該是和拉格朗日內插等價的。

## 幾何模塊說明

### 會圓術

輸入圓的半徑 r、弓形的高「矢」h、週天度。會圓術求法：半弦長 <code>c = sqrt (r^2 - (r-h)^2)</code>。尤其需要注意的是，會圓術的標準是週天度 365.25，直徑 121.75，卽「週三徑一」，這個單位系是以 3 爲標準，而非圓周率 π<n>鄧可卉<v>授時曆中的弧矢割圓術再探</v>，<v>自然科學史研究</v>2007(2)</n>，所以在與三角函數對照時，需要進行參照系轉換，詳見源代碼。可以發現，弧-矢之間的轉換誤差大約在 1 度以內，而弦長誤差多達 5 度餘，這是單位系不同造成的。在弧矢割圓術中，以弧作爲入口，用會圓術轉換爲弦長，最後再以弧作爲出口，將弦長轉換爲弧長，單獨來看，弦長的誤差相當大，但是在同一個單位系之中，這是自洽的。

### 弧矢割圓術

<img src="https://pic.imgdb.cn/item/60953023d1a9ae528f948bb3.png" width='270'>

圖中 AOE 是赤道，AOD 是黃道，BD 是已知的黃道度，求 CE 長，及赤道度。

<v>授時</v>用弧矢割圓術進行太陽黃赤轉換。<v>授時</v>黃赤轉換用幾何模型，此前的曆法都是經驗公式。由於會圓術的誤差，弧矢割圓術的誤差甚至比<v>紀元</v>的經驗公式還略差。弧矢割圓術是近似三角形、勾股定理、會圓術的組合，前兩者都是精確公式，只有會圓術是近似公式，那麼從理論上來講，如果用三角函數代替會圓術，就能得到和球面三角完全一致的結果，實際上也是這樣的。

授時只有黃度轉赤度的方法，我另外推導出了赤度轉黃度的方法：從 C 向上作垂線，與 OB 相較於點 T，T 超出了球體。從 P 向上作垂線，交 OD 於 Q。有了這兩條輔助線，就可以從赤轉黃了。

此處與天文標籤下授時黃赤轉換的區別是這裏可以隨意輸入黃赤交角。第一行「球面三角」是球面三角黃赤轉換的公式，第二行「三角割圓」是用三角函數代替會圓術的弧矢割圓術。弧矢割圓術在黃赤度數和黃赤交角在 45—50 度附近誤差達到最大，約 0.4 度。





### 三斜求積術

輸入三角形三邊邊長，求面積。秦九韶三斜求積術與希倫公式等價。

## 備忘

文科生可以看下這個：HFLSMathClub [数学基本符号介绍](https://zhuanlan.zhihu.com/p/254963486)