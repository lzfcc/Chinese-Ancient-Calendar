## 具注曆說明

〔天文曆說明見「天文」模塊〕曆書按月提供全年每一日的信息，中間彩色爲天文曆部分，其餘爲具注曆部分。由於內容很多，曆書只能計算一曆一年。

## 儒略日轉換爲公曆日期

之前都是每部曆法分別歸算出上元的儒略日數，再將積日等同於儒略日積日，算出公曆日期。這樣很麻煩，因爲每部曆法要單獨歸算，更重要的是經常會出現一日的誤差，找不到原因。現在新方法非常妙：假設公元 1000 年年前冬至 12 月 16 日乙酉儒略日 2086292 爲曆元，算出該年假想冬至儒略日

```javascript
OriginJdAccum = 2086292 + Math.floor(365.243 * (year - 1000))
```

再換算成干支序。另計算該曆冬至積日，兩者相減，卽

```javascript
OriginJdDif = (SolsAccum % 60 + 60) % 60 - Math.round((Math.round(OriginJdAccum) % 60 + 110) % 60.1)
```

最後，

```javascript
OriginJdAccum + OriginJdDif
```

卽是該曆冬至儒略日，各加距冬至日數得每日儒略日。

### 備忘

- 孔慶典、江曉原<v>七元甲子術研究</v>：

  > 该文内容为一个名为康遵的术士在开宝七年<n>974 年</n>为一位生于庚寅年丙戌月己巳日<n>卽 930 年 10 月 3 日</n>的人算命。注意到在文首中，庚寅年丙戌月己巳日标为「房日」

## 可靠性驗證

### 授時曆

與《授時曆故》1599年算例（《黃宗羲全集》18冊，2012，p304）相較，「推四正夜半黃道宿次」，春分密合，其餘幾個區別都很小。
