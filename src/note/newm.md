## 朔閏表說明

1.  可多選曆法；1 爲公元 1 年，0 爲公元前 1 年，-1 爲公元前 2 年；若僅需計算一年，在任意一框輸入年份卽可。 一曆一年爲 1 單位，最多可展示 400 單位的朔閏表，若超過 400 會自動下載到本地。
2.  第一行爲整年的情況，例如「積2759228 天紀己卯蔀49 大51小747 冬至12.5 閏餘6842閏11」的意思是：此年上元積年爲 2759228 年，入天紀己卯蔀 49 年，天正月大餘 51、小餘 747，冬至日數 12.5，閏餘 0.6842，按照閏餘法，11 月爲閏月。大餘加上蔀或紀名干支卽爲天正朔干支，如上例，己卯 16 + 大餘 51 = 67，mod (67, 60) = 7，正月朔爲庚午。四分曆日法爲 940，小餘 747 轉換爲十進制就是 747 / 940 ≒ 0.7947。冬至 12.5 同樣需要加上蔀干支。閏餘爲十進制，若以章法19爲單位，就是0.6842×19=13。
3.  「轉」表示冬至時刻入轉<n>近點月</n>日，「交」表示冬至時刻入交泛日<n>未加日月速度改正的入交點月日數</n>，「週」表示入週天度<n>恆星年</n>。
4.  劉歆<v>世經</v>論<v>三統</v>上元積年多爲算外，但也有用算上的；<v>殷曆</v> <v>周曆</v>等古四分曆，歷代學者論上元積年多用算上，但也有用算外的。統一起見，本表各曆上元積年均爲算外，入蔀<n>統</n>年均爲算上。
5.  置閏共有三種方法：閏餘法、無中氣法、固定冬至法，閏餘法可分爲年中置閏、年末置閏兩種，無中氣法閏月必在年中<n>當然也可能在最後一個月</n> ，固定冬至法閏月必在年末。漢代以後均採用無中氣法。古六曆並不確定採用何種置閏法，本工具能同時顯示三種置閏法的結果<n>超級獨家技術</n> ，以固定冬至法爲主。第一行最後標注的是閏餘年中置閏法的閏月，若採用閏餘年末置閏法，最後一個月就是閏月。中氣一行採用無中氣置閏法，有「□□」的年份爲無中氣置閏法的閏年，「□□」表示該月無中氣，爲閏月。需要留意的是，若固定冬至法閏年在閏餘法、無中氣法的上一年，那麼該年的閏餘法、無中氣法閏月數需要加 1 ，因爲固定冬至法把該年的第一個月往上年奪去了。固定冬至法的閏月必定置於年末；無中氣法的閏月可能比閏餘年中法提前或延後一個月：中氣與朔同在一日，中氣的時刻比朔早，則閏餘未達到閏準，還不能置閏；但是由於中氣與朔已經在一日了，上個月無中氣，需要置閏。
6.  本工具的另一個獨家技術是「算三年以求一年」：秦漢以後置閏採用無中氣置閏法，如果閏月在十二或一月，在特殊情況下閏年會推後或提前一年，因此欲求一年，需同時算前後一年，以應對特殊情況。這也就意味著，如果想算 10 年的朔閏，需要算 30 年。鑒於此，我們採用滾動數組，將之前的運算結果存儲下來，以空間換時間，算 10 年朔閏只需要算 12 年，經測試，這能減少近一半的計算時間。
7.  判斷大小月的方法：看天干是否相同。如一、二、三月的朔分別是辛亥、辛巳、庚戌，辛亥、辛巳天干一樣，說明一月有 30 日，爲大月；辛巳、庚戌天干不同，說明二月有 29 日，爲小月。
8.  「平朔」卽未考慮日月速度變化而得出的朔日，「平氣」卽未考慮日速度變化而得出的中氣日，「定朔」卽加上日月速度改正而得出的朔日，「定氣」卽加上日速度改正而得出的中氣日。干支下的數字爲小分，均爲十進制小數，如「8184」卽0.8184，換算成24小時制爲：0.8184 × 24 = 19.6416，0.6416 × 60 = 38.496，0.496 × 60 ≒ 30，卽19點38分30秒。小分到取小數點後四位，卽精度爲 8.64 s。各曆均有不同的辰法，需要您手動進行轉換。未來我可能會加入辰法自動轉換。
9.  「二次」表示用二次差內插法計算出的小分，「一次」表示用線性內插法計算出的小分，「三次」表示用三次差公式計算出的小分。若某曆有二次差定朔計算，則望干支及小餘爲二次差定望，其餘曆法同理。
10.  雖然漢末<v>乾象曆</v>便出現了定朔推步，但直到唐初<v>麟德曆</v>纔正式開始用定朔編排曆書，此前都是平朔注曆，定朔僅用於交食推步。雖然隋劉焯<v>皇極曆</v> 便發明了二次差計算定朔，但編排曆書時僅採用簡單的線性內插進行計算，二次差僅用於交食推步。爲了方便，本表進朔標準是高次內插所得小分。雖然<v>皇極曆</v>開始便可以計算定氣，但直到淸<v>時憲曆</v> 纔開始用定氣編排曆書，之前都是平氣注曆。本程序在平朔注曆時代用平朔編排閏月；在定朔推曆時代用二次差編排閏月、進朔，若遇一次差與二次差存在臨界差異，用戶大可進行手動調整<n>666 年二月麟德就出現了線性、二次改正分屬兩天的極端情況</n>。
11.  <v>元嘉</v>規定若月食發生在黎明之前，則屬上日，我把此規定用於所有的魏晉系曆法。干支減去1的，在定朔干支一格加上 <span class='NewmPlus'>-</span>，小分不變。<v>麟德</v>至<v>授時</v>之前行進朔法，我目前暫時簡單將 0.75 作爲進朔標準，進朔的月在干支後加上 <span class='NewmPlus'>+</span> 來表示，僅將干支加 1，小分不變。如「乙丑+」表示原本的干支是甲子，進朔爲乙丑，而小分與進朔前一致。如果遇到與文獻不一致的情況，用戶可根據小分自行調整進朔與置閏。
12.  日食在朔，月食在望。<span class='eclipse-symbol'>● ◐ ◔</span> 分別表示全食、偏食、光影相接虧蝕微少。隋代以前的交食計算非常原始，僅能根據交食週期判斷是否可能發生日月食。<v>乾象</v>僅能計算月食所在月，<v>景初</v>能根據去交度分判斷虧蝕程度，<v>正光</v>提出食分計算方法，<v>大明</v>沒有虧食的計算，<v>大業</v>以前的魏晉南北曆法均無全食限，均無法計算日食，僅能判斷是否交會。整齊起見，我將食分、虧蝕程度一槪補全。<v>大業</v>、<v>戊寅</v>沒有計算日食持續時間的方法，我姑且用月食來補。

## 幾個論題

### 置閏法

漢代以後皆用無中氣置閏法，卽沒有中氣的那個月置爲閏月。<v>太初</v>有一個特殊的置閏規則：<q>「中氣在朔若二日，則前月閏」</q>，但這條規則貫徹得並不徹底，有些前月朔，有些沒有前月朔，所以我的程序並沒有設置這條規則。<n>見斯琴畢力格等<v>太初曆特殊置閏問題</v>，<v>內師大學報</v>2007 年第 6 期，頁 748—753</n>

而先秦古六曆的置閏法並不清楚，有閏餘法、固定冬至法、無中法三種可能。他們的原理見 [大小月、無中氣置閏圖；固定冬至、無中氣置閏圖](https://kqh.me/post/midterm-leap)。

### 晝漏夜漏

晝夜的槩念也很迷惑。大部分曆法的昏明時長是 2.5 刻，`晝漏 = 日出至日入 + 2*昏明`，`夜漏 = 日至日出 - 2*昏明`，`夜半漏 = 夜漏 / 2`。各曆名詞各有不同。

- 「晨初餘數」是唐曆的槩念，在數據庫搜只有<v>唐志</v>有。`晨初餘數 = 日出 - 昏明`，只是單位換成了日法，因爲這時天矇矇亮，晨剛開始，所以叫晨初。
- <v>宣明</v>：`昏明小餘 = 夜半定漏`
- <v>欽天</v>晝夜分以日入日出爲界：`晝分 = 日入 - 日出`，`夜分 = 1 - 晝分`，單位是日法。
- 應天、乾元 `晨半分 = 日出 - 昏明`，`昏分 = 1 - 晨分`，`晝半分 = 日出`，`夜分 = 1 - 晝分`

大體而言，看到「晨昏」二字，就是日出日入加減了昬明 2.5 刻的，看到「晝夜」二字，就是日出日入。

### 進朔

唐代以前都是平朔注曆，戊寅曆始用定朔注曆，但李淳風說 645 年有四月連大，<q>「庚子，詔用仁均平朔」</q>，又暫停了用定朔注曆，直到<v>麟德</v>纔固定用定朔。<n>雖然<v>皇極</v>就發明了二次內插，但唐宋時期編排曆書依然用簡單的線性內插，精確的二次差只用於交食推算。</n>用定朔注曆，就會出現四大三小現象，還有閏月不好放置的問題，所以<v>麟德</v>提出進朔法作爲解決方案，此後唐宋閒沿用進朔法，直到<v>授時</v>廢除。

關於退望，<n>沒有「退望」這個詞，我爲了敘述方便而已。</n>曲安京：後半夜的月掩星 85% 用昨日干支，食甚在後半夜的月食，幾乎都用昨日干支。並且弦望在平旦之前都是昨日。<n><v>數</v>頁 306</n>關於進朔退望，我沒找到完整的參考資料，只能自己翻曆志。

發明進朔，景龍二年 708—開元四年 716、開元九年 721—十六年 728 用進朔法推排。<n>見黃一農<v>中國史曆表朔閏訂正舉隅———以唐麟德曆行用時期爲例</v>，<v>漢學研究</v>1992年2期，頁291—296</n>

各曆進朔規則：

- 麟德在無中氣置閏之後說：<v>新唐志</v>「其元日有交、加時應見者，消息前後一兩月，以定大小，令虧在晦二，弦、望亦隨消息。月朔盈朒之極，不過頻三。其或過者，觀定小餘近夜半者量之。」<v>舊唐志</v>「其正月朔有定加時正月者，消息前後各一兩月，以定月之大小。合虧在晦二者，弦望亦隨事消息。凡置月朔，盈朒之極，不過頻三。其或過者，觀定小餘近夜半者量之。」「其注歷，五乘弦望小餘，程法而一，為刻。不滿晨前刻者，退命算上。」

- 大衍：「若注曆，觀弦、望定小餘，不盈晨初餘數者，退一日。其望有交、起虧在晨初已前者，亦如之。又月行九道遲疾，則有三大二小。以日行盈縮累增損之，則容有四大三小，理數然也。若俯循常儀，當察加時早晚，隨其所近而進退之，使不過三大二小。其正月朔有交、加時正見者，消息前後一兩月，以定大小，令虧在晦、二。」

可見<v>麟德</v>、<v>大衍</v>二曆進朔很模糊，只是說看情況來定。之後的曆法都有比較明確的標準：


- <v>五紀</v>論與大衍所異者九：一曰「依大衍戌初進初朔，則朔之夕，月見西方矣。當視定朔小餘不滿五紀通法，如晨初餘數減十刻已下者，進以明日爲朔。」二曰「以三萬二千一百六十乘夜半定漏刻，六十七乘刻分從之，二千四百而一，爲晨初餘數。」

- <v>宣明</v>：「凡定朔小餘，秋分後，四分之三已上，進一日。春分後，昏明小餘差春分初日者，五而一，以減四分之三。定朔小餘如此數已上者，進一日。或有交，應見虧初，則否。定弦望小餘，不滿昏明小餘者，退一日。或有交，應見虧初者，亦如之。」又見<v>中國古代曆法</v>第570頁</n>

- <v>崇玄</v>：「其定朔小餘，如日法四十分之二十九已上；以定朔小餘減日法，餘如晨初餘數已下，進一日。」

- <v>欽天</v>：「定朔加時日入後，則進一日；有交見初則不進。弦望加時日未出，則退一日；日雖出有交見初亦如之。元日有交，則消息定之。」

- <v>應天</v>、<v>乾元</v>、<v>儀天</v>：「視朔所入辰分皆與二分相減，餘二收，用減八分之六，其朔定小餘如此；以上者進一日；朔或有交正見者，其朔不進。定望小餘在日出分以下者，退一日，若有虧初在<n>辰</n>〔晨〕分以下亦如之。」

- <v>崇天</v>：「凡注曆，觀朔小餘，如日入分已上者，進一日，朔或當定，有食應見者，其朔不進。弦、望定小餘不滿日出分，退一日，其望定小餘雖滿此數，若有交食虧初起在日出已前者，亦如之。有月行九道遲疾，曆有三大二小；若行盈縮累增損之，則有四大三小，理數然也。若俯循常儀，當察加時早晚，隨其所近而進退之，不過三大二小。若正朔有加交，時虧在晦二正見者，消息前後一兩月，以定大小。」崇天這段話和大衍幾乎一樣，那麼是否可以據此補出大衍進朔，也是「如日入分已上者，進一日」。

- <v>明天</v>、<v>觀天</v>、<v>紀元</v>：秋分—春分：0.75。<q>「若春分後，其定朔晨分差如春分之日者，三約之，以減四分之三；如定朔小餘及此數已上者，進一日；朔或當交有食，初虧在日入已前者，其朔不進。弦、望定小餘不滿日出分者，退一日；其望或當交有食，初虧在日出已前，其定望小餘雖滿日出分者，亦退之。又月行九道遲疾，曆有三大二小；日行盈縮累增損之，則有四大三小，理數然也。若循其常，則當察加時早晚，隨其所近而進退之，使月之大小不過連三。」</q><n>

進朔要求最多三大二小，不能四大三小，如果仍然出現，需要手動調整。日落之前若有日食初虧，則不進朔。

### 備忘

- <v>晉書</v>卷一七「黃初二年六月二十九日戊辰加時未日食⋯⋯黃初以爲加辛強。」
- <v>新唐志一</v>：<q>「仁均曆有三大、三小，云日月之蝕，必在朔望。十九年九月後，四朔頻大。」</q><u>李淳風</u>：<q>「古曆分日起於子半。⋯⋯<u>傅仁均</u>子初爲朔」</q>。

<v>宋律曆十四</v>、<v>疇人傳</v><v>陳得一</v>的一段內容可以作爲兩宋之際曆法復原的參考：1193 年 12 月紹興

> 南渡以後，星翁離散，<v>紀元術</v>亡。紹興二年，高宗重購得之。六月甲午，語輔臣曰：『術官推步不精，今術差一日，近得<v>紀元術</v>，自明年當改正。協時月正日，蓋非細事。』五年，日官言：『正月朔旦日食九分半，虧在辰正。』得一言：『當食八分半，虧在巳初。』其言卒驗。侍御史張致遠言：『今歲正月朔日食，太史所定不驗，得一嘗爲臣言，皆有依據。蓋患算造者不能通消息盈虛之奧、進退遲疾之分，致立朔有訛。凡定朔小餘七千五百以上者，進一日。紹興四年十二月小餘七千六百八十，太史不進，故十一月小盡；今年五月小餘七千一百八十，少三百二十，乃爲進朔，四月大盡。建炎三年定十一月三十日甲戌爲臘。<v>陰陽書</v>曰：<q>「臘者，接也。」</q>以故接新，在十二月近大寒前後戌日定之，若近大寒戌日在正月十一日，若即用遠大寒戌日定之，庶不出十二月。如宣和五年十一月二十七日丙午大寒，後四日庚戌，雖近，緣在六年正月一日，此時以十九日戊戌爲臘。得一於歲旦日食，嘗預言之，不差釐刻。願詔<u>得一</u>改造新秝，委官專重其事，仍盡取其書，參校太史有無，以補遺闕。擇秝算子弟粗通了者，授演撰之要，庶幾日官無曠，秝法不絕。』二月丙子，詔祕書少監朱震即祕書省監視得一改造新秝。八月秝成，震請賜名<v>統元</v>，從之。

- <v>跋吐鲁番文书中的两件唐历</v>說麟德 678 年閏十月，但是算出來閏十一月。

## 朔閏表可靠性驗證

### 一、敦煌具注曆日

與鄧文寬《敦煌天文曆法文獻輯校》核對，結果如下（版本 0.991.3）：

##### 太平真君十一、十二年（450—451）景初曆

451 大將軍在卯，程序在子。451年 的建除程序都錯開一日。朔閏、節氣都沒問題。，451 年二、八月紀錄了月食，沒問題。

##### 元和三年（808）具注曆

只有五月到六月的完整信息，與《正元》對照，建除相合，那麼年份應該沒錯。《正元》四月壬子平朔 5479，定朔 9278，五月平朔壬午 0785，定朔 4975，六月平朔辛亥 6091，定朔 9678；該曆六月辛亥朔，五月辛巳朔，倒推四月壬子朔。可能該曆是平朔注曆，比《正元》提前了 8 刻以上。

##### 元和四年具注曆

存四月戊申朔，閏四月丁丑朔，五月丙午朔，六月丙子朔，七月乙巳朔。《正元》閏三月丁未朔 9599 ，四月丙子朔 6279，五月丙午朔 2284，六月乙亥朔 7683。如果用進朔，則四月戊申比《正元》推遲 75 刻以上，五月丙午比《正元》推遲 55 刻以下，衝突了。

月神、吉時、建除、甲子納音相合。五月十六日辛酉血忌，程序沒有。

##### 元和十四年（819）具注曆

五月丁丑朔，六月丁未朔，七月丙子朔。《正元》五月戊寅 1198，六月丁未 7264，七月丁丑 3589。若用進朔，該曆比《正元》提前 60 刻以上，若不用，提前 36 刻以上。

建除相合。

##### 長慶元年（821）具注曆

二月戊辰，三月丁酉，四月丁卯，五月丙申，與《朔閏表》合。《正元》基本上沒問題，四月丙寅 7805，不進朔。

建除程序提前了一日

##### 大和三年（829）具注曆

十一月丁丑，十二月丙午，正月丙子。《宣明》829 十一月丁丑 5228，十二月丁未 1522，830 正月丙子 6939。若進朔，則該曆比《宣明》提前 40 刻以上，若不進朔，提前 16 刻以上。

##### 大和八年（834）具注曆

頁 141。有比較全面的宜忌指南。正月壬子，二月壬午，三月壬子，四月辛巳，五月辛亥，六月庚辰，七月庚戌，八月己卯，九月己酉，十月戊寅，十一月戊申，十二月丁丑。《宣明》正月壬子進朔癸丑 8330，四月辛巳進朔壬午 8383，十一月丁未 7204 不進朔。若按正、四月，該曆比《宣明》提前 10 刻以上，若按十一月，比宣明推遲 3 刻以上，互相衝突。氣、候與《宣明》相合。

歲神相合。建除程序錯開一日。

值得注意的是，該曆三月廿九庚辰是沒日，《宣明》沒在二月五日丙戌、四月十五日丙申。庚辰距冬至 145.04—146.04 日之間，那麼冬至後第一個沒日在 5.85—6.85 日⋯⋯以後可以復原一下。

##### 乾符四年（877）具注曆

一般認為該曆以《宣明》爲基礎，我算得該曆朔閏與《宣明》全合，其中六月庚午 7468 進朔庚午，十二月丁卯 7358 不進朔，均相合。建除、九宮、氣、候均相合。

##### ⋯⋯

其他的以後再核對，太多了。

### 二、朔閏表工具書

此前已經核對過四分曆法，應該完全可靠。從<v>乾象</v>開始，與<v>中國史曆日和中西曆日對照表</v><n>方詩銘、方小芬編著，上海人民出版社 2007。下簡稱<v>方表</v> 。@澤哥</n>相核對，紀錄如下<n>已下是版本 0.991 的情況，用二次內插定朔、二次內差計算日出分</n>：

#### 魏晉南北

<v>戊寅</v>以前平朔注曆。<v>乾象</v>、<v>景初</v>、<v>玄始</v>、<v>正光</v>、<v>天和</v>、<v>大象</v>、<v>開皇</v>、<v>大業</v>全合。

- 502 <v>元嘉</v>閏五月戊午，跟<v>輯要</v><v>朔閏考</v>一樣，但是<v>方表</v>是四月戊子閏
- 559 <v>天保</v>閏四月丁亥；<v>大明</v>、<v>梁武大同</v>閏五月丁巳
- 562 三曆不同閏，<v>梁武大同</v>跟北周閏一月相合
- 563 八月癸巳，<v>梁武大同</v>相合，<v>大明</v>、<v>天保</v>是壬辰
- 564 <v>梁武大同</v>閏九月丙戌，我是閏十月，不合。<v>天保</v>閏九，與<v>目錄</v>、<v>輯要</v>、<v>朔閏考</v>、<v>對照表</v>相合。

#### 唐

##### 戊寅

645 以前用戊寅定朔，之後用戊寅平朔。

- 623 程序三月丙子，<v>方表</v>丁丑
- 625 程序五月癸巳，<v>方表</v>甲午
- 635 程序四月丙申，<v>方表</v>丁酉，這在臨界點
- 637 程序八月壬子，<v>方表</v>癸丑，<v>目錄</v>壬子。如果是壬子就是三連小
- 640 程序十一月癸亥，<v>方表</v>甲子
- 642 程序、<v>目錄</v>二月丙戌，<v>方表</v>丁亥。程序四月乙酉，<v>方表</v>丙戌
- 643 程序十二月平朔定朔都是丙午，<v>方表</v>丁未
- 644 程序三月平定都是甲戌，<v>方表</v>乙亥，<v>目錄</v>甲戌
- 665 年比較奇怪，<v>方表</v>用的戊寅平朔，但似乎應該開始用麟德了

##### 麟德

<v>麟德</v>開始用定朔注曆，用進朔法，但觀<v>方表</v>，<v>麟德</v>、<v>大衍</v>都只是偶爾進朔，可能一年有一次，找不到什麼規律，<v>五紀</v>開始纔形成了比較規則的進朔規則。因此我以不進朔的麟德與<v>方表</v>相參照。

- 682 程序十二月庚申，<v>方表</v>己未，位於臨界點，似乎是<v>方表</v>錯了
- 684 程序正月癸未，<v>方表</v>甲申，進朔或平朔就是甲申
- 693 程序十二月乙卯，<v>方表</v>丙辰，進朔或平朔就是丙辰
- 697<v>方表</v>都進朔了，因此閏月也不一樣
- 698 十月<v>方表</v>丁亥，可是不管平朔定朔都是戊子，<v>方表</v>肯定錯了
- 703 十二月程序丁巳，<v>方表</v>戊午，進朔就是戊午
- 708 閏月進朔，其餘兩個月不進朔
- 709 有兩個月進朔，兩個月不進朔
- 710 全部進朔
- 711 閏六月、十一月不進朔
- 712 四月不進朔
- 713 二、九月不進朔
- 714 六、九月不進朔
- 715 九月不進朔，這樣就是三連大
- 716 除了閏十二月都進朔了，只是<v>方表</v>是閏十二不進，<v>輯要</v>、<v>朔閏考</v>、<v>總譜</v>、<v>對照表</v>都進朔
- 717 都不進
- 718 有兩個月進朔
- 719 都不進，但正月辛卯，而算出來平定朔都是庚寅，不進朔
- 720 都不進
- 721 只有六月進朔
- 722 只有閏五月進朔
- 723 全部進朔
- 724 只有八月戊子進朔。<v>方表</v>閏月在 724 閏十二，但程序 725 閏正，應該是<v>方表</v>出錯了。如果724閏十二月，下個中氣甲申就在丙戌之前了。一定是沒有用我的算三年以求一年之法。
- 725 全部進朔
- 726 七月不進朔
- 727 三月不進朔
- 728 都不進朔

##### 大衍

- 729 只有二月進朔
- 730 都不進朔，因此閏月也不一樣
- 731 都不進朔
- 732 都不進朔
- 733 十月不進朔，其餘兩個進朔
- 734 只有正月進朔
- 735 都不進朔
- 736 都不進朔
- 737 只有八月進朔
- 738 七月、閏八月進朔，其餘不進
- 739 都不進
- 740 都不進
- 741 全都進
- 742 全都進
- 743 正月不進
- 744 全都進
- 745 全都進
- 746 正月不進
- 747 八月不進
- 748 十一月不進
- 749 正、八、十一月不進
- 750 正月不進
- 751 全都進
- 752 三、五、十二月不進
- 753 六、十二月不進
- 754 七月不進
- 755 二、五、七月不進
- 756 沒有一個需要進朔
- 757 十二月不進
- 758 都進朔
- 759 都進朔
- 760 全都進。估計<v>方表</v>也是用大衍來排，沒用至德。
- 761 二月不進

##### 五紀

- 762 都進朔
- 763 六月壬申 8658<v>方表</v>進朔，程序不進
- 764 二月戊辰 8199<v>方表</v>進朔，程序不進
- 765 五月辛卯 8656<v>方表</v>進朔，程序不進
- 769 三連小，<v>方表</v>也沒調整進朔
- 770 八月庚寅 8146，<v>方表</v>進朔，程序不進
- 771 二月戊子<v>方表</v>不進朔，避免了四連大
- 774 正月不進，程序進。六月戊辰 9143<v>方表</v>進朔，程序不進
- 775 二月甲子 8546<v>方表</v>進朔，程序不進
- 778 七月甲辰 8251、九月癸卯 8283<v>方表</v>進朔，程序不進
- 779 正月壬寅 8610 程序進朔，<v>方表</v>不進。九月丁卯 7047<v>方表</v>進朔，程序不進，怎麼都不應該進
- 781 九月丙辰 8899 程序進朔，<v>方表</v>不進

##### 正元

- 786 八月戊午8961程序進朔，<v>方表</v>不進
- 787 四月甲寅8834<v>方表</v>進朔，程序不進
- 791 五月庚申9572程序進朔，<v>方表</v>不進
- 793 七月丁丑9527程序進朔，<v>方表</v>不進
- 795 三月戊辰8339<v>方表</v>進朔，程序不進。十月甲子8683程序進朔，<v>方表</v>不進
- 796 三月壬辰8800<v>方表</v>進朔，程序不進。十月戊午8558程序進朔，<v>方表</v>不進
- 797 二月丁巳8800<v>方表</v>進朔，程序不進
- 803 十月戊寅8813程序進朔，<v>方表</v>不進
- 804 九月壬申8788程序進朔，<v>方表</v>不進
- 805 正月辛未8606程序進朔，<v>方表</v>不進

##### 觀象<n>正元代</n>

- 808 庚戌 7799<v>方表</v>進朔，程序不進
- 810 六月己巳 9055<v>方表</v>進朔，程序不進。十一月丁酉7214<v>方表</v>進朔，程序不進
- 811十二月辛酉 7868<v>方表</v>進朔，程序不進
- 812 正月庚申 7386<v>方表</v>進朔，程序不進。十二月乙酉 7921<v>方表</v>進朔，程序不進
- 813 二月甲申 8073<v>方表</v>進朔，程序不進
- 814 三月戊申 8088<v>方表</v>進朔，程序不進。十二月癸卯 8218<v>方表</v>進朔，程序不進
- 815 六月庚子 7535<v>方表</v>進朔，程序不進。九月戊辰 8165<v>方表</v>進朔，程序不進。十二月丁酉8007<v>方表</v>進朔，程序不進
- 816 七月甲子 7676<v>方表</v>進朔，程序不進。十月壬辰 8145<v>方表</v>進朔，程序不進
- 817 五月己丑 8824<v>方表</v>進朔，程序不進，閏月也不一樣
- 820 三月壬寅 8507<v>方表</v>進朔，程序不進。五月辛丑 8308<v>方表</v>進朔，程序不進
- 821 四月丙寅 7805<v>方表</v>進朔，程序不進

##### 宣明

- 824 程序九月丁未，<v>方表</v>丙午，<v>目錄</v>、<v>輯要</v>、<v>朔閏考</v>、<v>方表</v>都是丁未
- 826 五月丁卯 7274<v>方表</v>進朔，程序不進
- 832 八月庚申 7488<v>方表</v>進朔，程序不進
- 836 六月戊戌 8720 程序進朔，<v>方表</v>不進，沒有理由不進
- 842 十二月庚申9018程序進朔，<v>方表</v>不進，沒有理由不進
- 845 正月戊申7479<v>方表</v>進朔，程序不進
- 852 八月甲子7967程序進朔，<v>方表</v>不進，因此閏月也不一樣。莫名其妙
- 856 二月甲戌7527程序進朔，<v>方表</v>不進
- 858 六月庚寅6988<v>方表</v>進朔，程序不進，沒有理由進朔
- 875 五月壬午7354<v>方表</v>進朔，程序不進
- 886 九月丙子7399<v>方表</v>進朔，程序不進
- 891 七月戊申7602程序進朔，<v>方表</v>不進
- 892 四月甲戌7522程序進朔，<v>方表</v>不進

##### 崇玄

- 893 五月戊戌7811<v>方表</v>進朔，程序不進，閏月也不一樣，照理說不進。
- 895 六月丙戌7611<v>方表</v>進朔，程序不進
- 896 四月辛亥8140<v>方表</v>進朔，程序不進
- 899 四月癸亥7551<v>方表</v>進朔，程序不進
- 901 四月壬子7632<v>方表</v>進朔，程序不進。六月庚辰8102<v>方表</v>進朔，程序不進
- 902 四月丙子8061<v>方表</v>進朔，程序不進
- 903 五月庚子8105<v>方表</v>進朔，程序不進
- 904 五月甲子7527<v>方表</v>進朔，程序不進
- 905 九月丙辰7610<v>方表</v>進朔，程序不進
- 910 三月庚寅7751<v>方表</v>進朔，程序不進
- 912 五月戊寅8063<v>方表</v>進朔，程序不進
- 913 三月癸卯7557<v>方表</v>進朔，程序不進
- 914 九月甲午7554<v>方表</v>進朔，程序不進
- 919 三月戊辰7861<v>方表</v>進朔，程序不進
- 921 四月丙辰7798<v>方表</v>進朔，程序不進
- 924 七月丁酉 7720<v>方表</v>進朔，程序不進。九月丙申 7513
- 927 五月庚戌7821。七月己酉 7190，但是怎麼都不能進
- 929 三月庚午 7872
- 932 四月壬子 8014
- 934 六月己巳 7577
- 936 五月戊子 7457。十二月乙酉 7500 程序進朔，<v>方表</v>不進

從<v>方表</v>來看，937 開始就不是崇玄了。937 以後暫且不管

#### 五代宋

##### 欽天

- 956 十月己未 6017<v>方表</v>進朔，程序不進，完全沒有理由進朔
- 958 九月戊申5776遼戊申，周己酉。
- 959十月壬申6936<v>方表</v>進朔，程序不進。十二月辛未5643。周壬申，<v>方表</v>進朔，程序不進。遼辛未
- 960七月戊戌6931<v>方表</v>進朔，程序不進
- 961六月壬辰7403<v>方表</v>進朔，程序不進。九月辛酉6633<v>方表</v>進朔，程序不進
- 963七月庚戌6755<v>方表</v>進朔，程序不進

##### 應天

- 964 九月癸酉 7390<v>方表</v>進朔，程序不進
- 966 六月 7645 甲午程序進朔，<v>方表</v>不進
- 968 正月甲申 7265<v>方表</v>進朔，程序不進。四月癸丑 7733 程序進朔，<v>方表</v>不進
- 970 六月庚午 7331 程序進朔，<v>方表</v>不進
- 972 六月戊子 7635 程序進朔，<v>方表</v>不進。十二月丙戌 7120<v>方表</v>進朔，程序不進
- 974 五月戊申 8045 程序進朔，<v>方表</v>不進，沒有理由不進
- 978 十二月辛亥 7253<v>方表</v>進朔，程序不進
- 981 十一月甲午 7466<v>方表</v>進朔，程序不進
- 982 四月壬戌 7841 程序進朔，<v>方表</v>不進。十一月戊子7413<v>方表</v>進朔，程序不進

##### 乾元

- 983 閏月不對
- 986 二月己亥 7094<v>方表</v>進朔，程序不進。怎麼都不應該進
- 989 五月庚辰 7346 程序進朔，<v>方表</v>不進。
- 991 閏三月庚子 7506 程序進朔，<v>方表</v>不進。閏月也不一樣
- 994 正月癸丑 7276<v>方表</v>進朔，程序不進。四月壬午 7730 程序進朔，<v>方表</v>不進
- 996 七月己亥 7307 程序進朔，<v>方表</v>不進
- 997 十二月辛卯 7466<v>方表</v>進朔，程序不進

##### 儀天

- 1001 正月癸酉 7049<v>方表</v>進朔，程序不進。十月戊戌 7248<v>方表</v>進朔，程序不進。十二月丁卯 6686<v>方表</v>進朔，程序不進，閏月也不一樣，怎麼都不應該進
- 1002 十月壬戌 7482<v>方表</v>進朔，程序不進
- 1018 十月己丑 7111<v>方表</v>進朔，程序不進，沒有理由進朔
- 1020 二月壬午 7295<v>方表</v>進朔，程序不進，沒有理由進朔
- 1021 十二月辛丑 7034<v>方表</v>進朔，程序不進，沒有理由進朔

##### 崇天

- 1024 十二月甲寅 9857 程序進朔，<v>方表</v>不進，無論如何都應該進
- 1027 正月壬寅 7757 程序進朔，<v>方表</v>不進，是為了避免四連大
- 1031 四月丁丑 7533<v>方表</v>進朔，程序不進
- 1033 六月甲午 8147 程序進朔，<v>方表</v>不進
- 1041 八月丁丑 7649<v>方表</v>進朔，程序不進
- 1044 十一月戊午 7490 程序進朔，<v>方表</v>不進
- 1053 二月辛未 7363 程序進朔，<v>方表</v>不進
- 1057 四月丙午 7649<v>方表</v>進朔，程序不進
- 1059 四月甲子 7471<v>方表</v>進朔，程序不進
- 1073 十二月庚午 7372 程序進朔，<v>方表</v>不進

##### 明天

這三年暫時不管

##### 奉元<n>擬</n>

- 1075 正月癸巳 7375<v>方表</v>進朔，程序不進
- 1076 五月乙卯 7478<v>方表</v>進朔，程序不進
- 1089 正月壬申 7764 程序進朔，<v>方表</v>不進，避免了四連大

##### 觀天

- 1097 正月丙戌 7512 程序進朔，<v>方表</v>不進

##### 占天

- 1103 八月丁未 7503 程序進朔，<v>方表</v>不進

##### 紀元

- 1121 九月壬戌 7482程序進朔，<v>方表</v>不進
- 1122 九月丙辰 7441<v>方表</v>進朔，程序不進

##### 統元

- 1152 正月丙申 7359<v>方表</v>進朔，程序不進

- 統元實行期間與紀元並推：

  > 統元曆頒行雖久，有司不善用之，暗用紀元法推步而以統元爲名。乾道二年，日官以紀元曆推三年（1167）丁亥歲十一月甲子朔，將頒行，裴伯壽詣禮部陳統元曆法當進作乙丑朔，於是依統元曆法正之。

也太絕了，我算出來紀元 1167 年十一月甲子平朔 6154，線性定朔 7506，秋分到春分是 0.75 進朔，差了 0.0007，什麼毛病⋯⋯該日入轉 15.2674，距第二年冬至 2.1114。線性改正，月：`867 +  0.2674 (1510 - 867) =  1038.9382`，日 `385 * 2.1114 / 15.2185 = 53.4145`，`日月改正 = (-53.4145 + 1038.9382) / 7290 = 0.1352`，則 `線性定朔 = 0.6154 + 0.1352 = 0.7506 `。呃⋯⋯和手算結果一樣，服了。有可能是 0.7506 四捨五入就是 0.75，於是不進朔了？

##### 乾道

- 1168 十月己丑<v>方表</v>戊子，但定朔在己丑
- 1174 五月丙戌 7454 程序進朔，<v>方表</v>不進
- 1176 正月定位 7640 程序進朔，<v>方表</v>不進

##### 淳熙

- 1178 十月庚寅 7526<v>方表</v>進朔，程序不進

##### 統天

- 1205 五月丁巳 8025 程序進朔，<v>方表</v>不進
- 1207 十一月壬申 7296<v>方表</v>進朔，程序不進

##### 開禧

- 1209 十月辛酉 7479 程序進朔，<v>方表</v>不進
- 1225 三月辛酉 7522 程序進朔，<v>方表</v>不進
- 1248 八月乙亥 7137<v>方表</v>進朔，程序不進
- 1249 八月己亥 7407<v>方表</v>進朔，程序不進
- 1251 七月己未 5592<v>方表</v>進朔，程序不進。十一月丙戌 7520 程序進朔，<v>方表</v>不進

##### 淳祐<n>擬</n>

- 1252 正月乙酉 7406 <v>方表</v>進朔，程序不進

##### 會天<n>擬</n>

- 1256 七月己丑 7246，<v>寶祐四年會天曆</v>進朔庚寅，程序不進。按照紀元進朔規則，需要小餘 0.7375 以上
- 1257 七月癸丑 7059<v>方表</v>進朔，程序不進
- 1258 八月丁丑 7444<v>方表</v>進朔，程序不進
- 1261 三月壬戌 7556<v>方表</v>進朔，程序不進
- 1263 二月辛亥 7630 程序進朔，<v>方表</v>不進。十月戊申 0740 平定朔都在戊申，不應該是丁未。十一月丁丑 7880 程序進朔，<v>方表</v>不進
- 1265 六月丁卯 7046<v>方表</v>進朔，程序不進
- 1266 七月辛卯7071<v>方表</v>進朔，程序不進
- 1267 五月丁亥 7507 程序進朔，<v>方表</v>不進
- 1270 閏十一丙寅 8154 程序進朔，<v>方表</v>不進

##### 成天

- 1273 六月辛巳 7404 程序進朔，<v>方表</v>不進
- 1275 七月己巳 7221<v>方表</v>進朔，程序不進
- 1276 二月丙申 7600 程序進朔，<v>方表</v>不進

##### 賈俊大明<n>995—1136</n>

根據<v>方表</v>的閏月，以<v>宣明</v>爲參考，999 年賈俊大明氣要比宣明少 0.2478 以上，996 年 0.2621 以下，1015 年要在 0.4732 以上。好吧，結論就是這些朔閏表都是胡亂排的。

##### 楊級大明<n>1137—1181</n>

- 1147 三月甲子 5972<v>方表</v>進朔，程序不進。十月辛卯 7616 程序進朔，<v>方表</v>不進
- 1155 九月乙巳 7306<v>方表</v>進朔，程序不進
- 1163 八月己未 7438<v>方表</v>進朔，程序不進

##### 重修大明<n>1181—1280</n>

- 1205 五月丁巳 7952 程序進朔，<v>方表</v>不進
- 1207 五月乙亥 7598 程序進朔，<v>方表</v>不進
- 1209 正月乙未 7109<v>方表</v>進朔，程序不進
- 1248 八月乙亥 7144<v>方表</v>進朔，程序不進
- 1249 八月己亥 7460<v>方表</v>進朔，程序不進
- 1250 四月丙申 7391 程序進朔，<v>方表</v>不進
- 1258 八月丁丑 7491 程序進朔，<v>方表</v>不進
- 1266 七月辛卯 7103<v>方表</v>進朔，程序不進
- 1267 五月丁亥 7459 程序進朔，<v>方表</v>不進
- 1269 五月乙巳 7159<v>方表</v>進朔，程序不進
- 1273 六月辛巳 7370 程序進朔，<v>方表</v>不進
- 1274 六月乙巳 7086<v>方表</v>進朔，程序不進
- 1275 七月己巳 7325<v>方表</v>進朔，程序不進 

#### 授時大統

一般認爲，<v>大統</v>全襲<v>授時</v>，只是取消歲實消長；用 / (月實行-日平行) 取代 / 月實行。但是據<v>大統曆書</v>，依然用的是<v>授時</v>的 / 月實行。跟大統曆書核對，我的計算分毫不差。<n>見 廖育棟 [明朝<v>大統曆</v>的定朔計算及曆表朔日訂正](https://ytliu0.github.io/ChineseCalendar/MingCalendar_chinese.html)</n>

### 總結

對於一般文史研究者，在我研究出什麼之前，正常情況下直接看工具書好了，不要用我這個。在<v>紀元</v>以前，程序算出來的跟工具書上的差異太大了，這些差異基本上都是進朔引起的，<v>授時</v>取消進朔，便與實行曆書分毫不差。不知道工具書是怎麼算的，不知道工具書跟當時的實行曆書有多大差異，以後都要慢慢研究。

- 撲朔迷離的<v>麟德</v>、<v>大衍</v>進朔。我實在沒看出有什麼規律，留待以後慢慢研究。
- 撲朔迷離的<v>戊寅</v>定朔，與<v>方表</v>不合，可能的原因是注曆沒有算日躔改正？
- <v>正元</v>感覺是個系統性問題，九十月進而不進，三月不進而進，要重新考慮<v>正元</v>、<v>五紀</v>進朔規則。

進朔差異原因分析：

1. 確定的是，出現四連大就會手動調整，程序沒法調。但好像不太顧忌三連小。
2. 有日食則不進朔，但我暫時沒考慮日食。
3. 日出分是按照節氣分段，而非每日連續。（應該不大可能）
4. 上面備忘那段材料：「今年五月小餘七千一百八十，少三百二十，乃爲進朔」，說明編曆人員的疏忽也是很有可能的事。
5. ~~定朔用線性內差，日出也可能用線性內差，我都用的二次內插。刪掉~~
6. 天知道。

<v>中國古代曆法</v>頁 570 將根據術文計算的<v>宣明</v>曆譜與工具書進行比較，結果是：

> 與<v>歷代長術輯要</v>比較，878 個月朔中有 11 個不同，都發生在進朔的邊緣狀態。11 個中有 7 個我們的計算結果與<v>資治通鑑</v>所收劉義叟的<v>長曆</v><n>簡稱<v>目錄</v></n>相同，4 個不同。⋯⋯三家曆譜有一定差異⋯⋯有待進一步考察。