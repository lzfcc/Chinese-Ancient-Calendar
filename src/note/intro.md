## 簡介

1.  本工具的使用對象是古代天文曆法研究者。對於一般文史研究者，推薦使用下面的友情鏈接<n>當然，「時間」板塊的三個工具還是挺有用的</n>。
2.  目前的古代朔閏査詢網站都是根據工具書、文獻材料手動調整的<n>參考中研院 [兩千年中西曆轉換說明書](https://sinocal.sinica.edu.tw/lusodoc.html)，廖育棟 [本網站的農曆編算](https://ytliu0.github.io/ChineseCalendar/computation_chinese.html)</n>。本工具可提供古代實行未實行的 60 餘部曆法<n>包括我復原的 8 部魏晉南北朝曆法、2 部隋曆、3 部唐曆、5 部宋曆、1 部金曆</n>的計算，完全遵照各曆算法進行全自動計算，無手動干預。主要有三大功能區：
    1.   **朔閏表** 每年的積年、冬至大小餘、閏餘；冬至時刻的入轉日、入交泛日、入週天度。各月定朔<n>線性內插、二次三次內插</n>、平朔，定朔時刻日月所在赤道度，定望，平氣、定氣、定氣日昏中星。日月食食甚時刻、食分。
    2.   **曆書** 包含天文曆、具注曆兩部份。
        1.  天文曆：每日太陽赤經、極黃經宿度，日赤緯、日出時刻、正午晷長，月赤經、月赤緯、月行九道/三道。預計 2022 年將推出五星計算。
        2.  具注曆：每年「術數年」積年、男女九宮，年干支五行、納音、魁罡之月，23 種歲神，年九宮色。每月月建、月神、吉時、月九宮色。每日干支、儒略日、公曆日期、納音五行、建除、黃道吉日黑道凶日、七星值日、二十八宿二十八禽值日，二十四節氣時刻、七十二候時刻、沒滅日時刻、土王用事時刻、卦用事時刻，人神、日遊神、血支血忌，10 種日神。
    3.   **數學工具** 包含同餘、方程、天文、時間四個板塊。
        1.  同餘：大衍求一術、解一次同餘式、大衍總數術，擬秦九韶調日法、淸人調日法三種、連分數，最大公因數、章蔀紀元法，古曆入元、秦九韶演紀法，從零開始造唐宋曆。
        2.  方程：~~九章算術開方術、累減開方術，~~二分迭代法解高次方程，隙積術芻童垛、三角垛落一形垛、四角垛方垛，招差術、拉格朗日內插，會圓術、弧矢割圓術、三斜求積術。
        3.  天文：日躔月離及誤差，太陽赤黃經轉換及誤差，太陽去極度、赤緯、日出、晷長及誤差，月亮極白經、赤經、極黃緯，現代天文任意時刻太陽高度、方位角、晷長。
        4.  時間：將萬分小數轉換爲辰刻，儒略日、日期轉換，公元年、年干支轉換。
3.  如您發現任何問題，可通過評論框或郵件向我反饋。本程序目前未經過文獻檢驗，且急就草創，錯漏叢生，**尙不能用於正式學術研究**。目前完全可靠的是古四分曆，可完全替代朱桂昌<v>顓頊日曆表</v>、<v>太初日曆表</v>、<v>後漢四分日曆表</v>三部大轉頭。若您在研究過程中發現程序結果與文獻不符，望不吝提供線索。這個工具是根據研究需要而開發的，如果您有任何功能需求，敬請與我聯繫，我會在力所能及的範圍內儘量實現。
5.  本工具與以往的朔閏表工具書是相互補充的關係，古人算曆有可能不會完全依照術文，會根據實際情況適當調整，這種情況下我們的計算程序就無能爲力。
6.  本工具完全開源，如您需要査詢、核査各曆的詳細參數與算法，請前往源碼倉庫。如您不嫌麻煩，可以下載源碼，在本地運行程序。更多技術特徵見開發者說明。全站文件大小：1.3MB，核心計算邏輯：191KB。 **隱私聲明** 本站使用了 Google Analytics 進行流量分析；評論系統採用 Hyvor Talk；服務器託管在 Netlify 平臺。運算均在本地瀏覽器進行。

## 網站推薦

### 年表

- [廖育棟的網站](https://ytliu0.github.io/ChineseCalendar/index_chinese.html)年曆、氣朔時刻、中國歷史年表、儒略日干支轉換等
- 中研院 [兩千年中西曆轉換](https://sinocal.sinica.edu.tw/)
- [歷史車輪中西曆轉換器](https://www.lishichelun.com/calendar/switch)

### 實行曆法

- [時憲曆計算](https://ytliu.epizy.com/Shixian/index_chinese.html?i=1)
- [紀年轉換工具](https://kanasimi.github.io/CeJS/_test%20suite/era.htm)：世界各國曆法

### 現代天文學中曆

- [日梭萬年曆](http://www.tianqihoubao.com/calendar/calendar.htm)，似乎是中科院背景
- [壽星天文曆](http://www.nongli.net/sxwnl/)，許劍偉、鄭彥山
- [萬年天文夏曆](https://vert.neocities.org/cld/)，哂蟹齋

### 現代天文學朔閏、交食

- [NASA Eclipse](https://eclipse.gsfc.nasa.gov/)
- [Astronomy and numerical software source codes](http://www.moshier.net/#Cephes)

## 參考資料

這個網站是古代曆法研究者的共同智慧結晶，在此表示感謝<n>太多了，我就只列作者和篇名</n>：

### 古籍

- 各史曆志
- 開元占經
- 寶祐四年會天曆
- 同光四年具注曆
- 梅文鼎<v>梅氏叢書輯要</v>
- 李銳<v>李氏遺書</v>

### 專書、論文集

- 劉洪濤<v>古代曆法計算法</v>
- 張培瑜等<v>中國古代曆法</v>
- 陳美東<v>古曆新探</v>
- 曲安京<v>中國數理天文學</v>
- <v>秦九韶與數書九章</v>

### 論文

#### 躔離氣朔

- 陈美东：日躔表之研究
- 陈美东：月离表初探
- 徐传胜：<v>乾象历</v>月离表数理分析
- 尚晓清：<v>大衍历</v>定朔算法及程序说明
- 滕艳辉：<v>纪元历</v>定朔算法模型及分析
- 滕艳辉等：<v>纪元历</v>等8部宋代历法的定朔推步及精度分析
- 马莉萍：中国古代历法中合朔时的太阳位置
- 王荣彬：中国古代历法的中心差算式之造术原理
- 李勇：中国古历定朔推步综述
- 李勇：中国古历经朔数据的恢复及应用
- 滕艳辉：宋代历法中的置闰算法
- 李勇：明嘉靖六年<v>大统历</v>历书的气朔推步精度
- 李亮：明代历法的计算机模拟分析与综合研究

#### 天文計算

- 陈美东：中国古代有关历表及其算法的公式化
- 王锦瑞：<v>明天历</v>岁差与上元积年
- 陈美东：中国古代太阳视赤纬计算法
- 江晓原：中国古代对太阳位置的测定和推算
- 陈美东：中国古代昼夜漏刻长度的计算法
- 纪志刚：麟德历晷影计算方法研究
- 陈美东：中国古代月亮极黄纬计算法
- 陈久金：九道术解
- 周靖：月行九道考
- 曲安京：<v>授时历</v>的白赤道坐标变换法

#### 交食

- 刘金沂：隋唐历法中入交定日术的几何解释
- 滕艳辉：<v>戊寅元历</v>的日月食推算方法
- 刘金沂：麟德历交食计算法
- 滕艳辉：宋代朔闰与交食研究
- 滕艳辉：<v>崇天历</v>的日食推步术
- 袁敏：<v>明天历</v>日食算法分析
- 滕艳辉：<v>纪元历</v>日食算法及精度分析
- 李勇：<v>授时历</v>交食推步研究
- 唐泉：<v>授时历</v>和<v>回回历法</v>中的日食时差算法
- 李勇：中国元明时期交食推步的比较研究
- 陈美东：中国古代的月食食限及食分计算法
- 曲安京：中国古代日食食限与食分算法
- 滕艳辉：宋代的日食食限算法
- 曲安京：中国古代的日食时差算法
- 唐泉：中国古代的日食食分算法
- 曲安京：中国古代的月食时差算法
- 李鉴澄：中国历代日月交食周期的研究
- 马莉萍：中国古代交食的宿度记录及其算法

#### 曆法數學

- 陈久金：调日法研究
- 李继闵：关于调日法的数学原理
- 刘钝：李锐顾观光调日法工作述评
- 李继闵：再评清代学者的调日法研究
- 曲安京：中国古代的二次求根公式与反函数
- 曲安京：唐宋历法演纪上元实例及算法分析
- 曲安京：东汉到刘宋时期历法上元积年计算
- 王翼勋：开禧历上元积年的计算
- 王翼勋：秦九韶演纪积年法初探
- 王锦瑞：<v>明天历</v>天文常数系统中的缺陷解析

#### 招差術

- 李兆华：朱世杰招差术探原
- 李兆华：朱世杰的垛积术与四次内插法
- 李兆华：<v>平立定三差详说</v>的一点注记
- 曲安京：<v>皇极历</v>中的漏刻差分表
- 刘钝：<v>皇极历</v>中等间距二次插值方法术文释义及其物理意义
- 武家璧：<v>大衍历</v>日躔表的数学结构及其内插法
- 曲安京：<v>大衍历</v>晷影差分表的重构
- 王荣彬：中国古代历法三次差插值法的造术原理
- 陈美东：<v>崇玄</v><v>仪天</v><v>崇天</v>三历晷长计算法及三次差内插法的应用

#### 普通曆法

- 刘次沅：<v>史记历术甲子篇</v>探讨
- 严敦杰：补北齐书历志
- 黃一農：中國史曆表朔閏訂正舉隅—以唐麟德曆行用時期爲例
- 钮卫星：符天历历元问题再研究
- 陈久金：符天历研究
- 孔庆典：七元甲子术研究
- 陈久金：回人马依泽对宋初天文学的贡献
- 邱靖嘉：<v>遼史曆象志</v>溯源——兼評晚清以來傳統曆譜的系統性缺陷
- 邱靖嘉：<v>辽史</v>所见祖冲之<v>大明历</v>的文献价值发覆

#### 具注曆

- 李勇：中国古历中的步发敛
- 朱双双：中国古历没灭术研究
- 何啓龍：<v>授時曆</v>具注曆日原貌考
- 金身佳：敦煌写本宅经P.3594九方色图试释
- 宁宇：敦煌写本时日宜忌文书之思想主题探赜
- 邓文宽：敦煌古历丛识
- 邓文宽：敦煌文献S2620号唐年神方位图试释
- 華瀾：敦煌曆日探研
- 邓文宽：跋吐鲁番文书中的两件唐历
- 何伟凤：黑水城出土元代历日研究

#### 數學

- 甘向阳：<v>九章算术</v>刘徽注中的算法分析工作与算法分析思想
- 陈巍：<v>五经算术</v>的知识谱系初探
- 沈康身：<v>数书九章</v>大衍类算题中的数论命题
- 汪晓勤：<v>数书九章</v>大衍类算题的若干注记
- 一次同余式组的程序求解
- 陈维海：用BASIC程序实现求高次方程实根的斯特姆秦九韶方法
- 朱一文：秦九韶「历家虽用用而不知」解
- 侯钢：秦九韶大衍总数术中问数化定数算法解析
- 王翼勋：从大衍术到大衍求一术
- 段耀勇：刘徽开方与增乘开方法
- 梅荣照：贾宪的增乘开方法_高次方程数值解的关键一步
- 李兆华：增乘开方法与贾宪三角形
- 傅宗：隙积术和会圆术——沈括<v>梦溪笔谈</v>评注一则

#### 現代天文

- 李文：地球椭球模型中太阳位置计算的改进
- 张富、张丽娟、邱本志：一种计算太阳低仰角蒙气差的有理函数逼近方法
- 丁豔、袁隆基、趙培濤、仝軍令：太陽視日軌跡跟蹤算法研究

## 开发者说明

### 1

- 计算程序采用 JavaScript 编写
- 前端框架采用 React
- 本地框架为 Node。在本地运行本程序，需要安装 Node 13.2 以上版本
- 朔闰表、历书采用 Web Worker，实现 UI 线程与计算线程分离
- 朔闰表采用懒加载，大幅压缩渲染时间
- 采用 WebPack 打包
- 采用 [Decimal.js](https://mikemcl.github.io/decimal.js/)<span classname="decimal64">.64</span>进行小数点后 64 位大数字运算，采用 [fraction.js](https://www.npmjs.com/package/fraction.js)<span classname="decimal64">n/d</span>进行分数运算，采用 [nzh](https://blog.whyoop.com/nzh/docs) 进行阿拉伯数字、汉字转换

<del>本仓库基于组件化、工程化的考量，将核心模块<n>计算逻辑</n>拆分到了单独的仓库<n>ancient-calendar</n>中，通过子模块进行依赖，从而前端展示<n>View</n>和计算逻辑<n>Model</n>可以独立开发，前端直接引用子模块的函数进行运算。</del>

由于运算都在前端进行，在进行大量运算时会卡住 UI，体验较差。为了改进这一问题，我们决定改用 Web Worker<n>前端的多线程</n>。这样就必须将 `Worker()` 构造函数的参数文件独立放在 public 目录下<n>不能参与 webpack 打包</n>，因而不能直接引用子模块，必须将子模块打包成一个文件：

1. 全局安装 webpack，webpack-CLI

```
$ npm install -g webpack webpack-cli
```

2. 打包 main.js

```
$ webpack ./src/Cal/output_frontend-worker.mjs -o ./public
```

3. $ npm run build

### 2

核心计算程序在 `/src/Cal` 目录下，有 9 个板块，各文件功能说明：

- `para_` 参数
    - `para_constant` 常量参数
    - `para_1` 四分魏晋南北系历法参数
    - `para_2` 隋唐宋元历法参数
- `newm_` 朔闰表模块
    - `newm` 朔闰计算
    - `newm_quar` 四分历朔闰计算
    - `newm_index` 朔闰计算汇总调整输出
- `day_` 历书模块
    - `day` 历书计算
    - `day_luck` 历书中岁神、日神的计算
- `astronomy_` 天文模块
    - `astronomy_acrv` 日月速度改正
    - `astronomy_eclipse` 日月交食
    - `astronomy_Accum2Mansion` 黄赤道积度转换为入宿度
    - `astronomy_formula` 使用公式进行计算的历法，`astronomy_table` 使用表格进行计算的历法，`astronomy_west` 使用现代方法进行计算。包含黄赤转换、经纬转换、月亮坐标转换
    - `astronomy_other` 積度轉宿度，進朔，月行九道
- `modulo_` 同馀模块
    - `modulo_continued-frac` 分数连分数
    - `modulo_continued-frac1` 小数连分数
    - `modulo_denom` 调日法
    - `modulo_exhaustion` 从零开始造宋历
    - `modulo_gcdlcm` 最大公因数
    - `modulo_origin` 演纪
    - `modulo_qiuyi` 大衍求一术
- `equa_` 方程模块
    - `equa_geometry` 几何
    - `equa_high` 解高次方程
    - `equa_math` 数字格式转换
    - `equa_sn` 垛积
    - `equa_sqrt` 开方
- `time_` 时间模块
    - `time_decimal2clock` 日分转换为辰刻
    - `time_era` 年干支转换
    - `time_jd2date` 儒略日、日期转换
- `bind_` 路由模块
    - `bind` 根据历法自动选择朔闰计算
    - `bind_astronomy` 根据历法自动选择天文计算
- `output_`其他
    - `output` 输出准备
    - `output_print` 本地打印入口。`const printData = outputFile(2, 1255, 1255, 0` 第一个数字为模式，`1` 为朔闰表，`2` 为历书；第二三个数字为起始年、终止年；第四个数字为自动长历模式开关，目前暂不支持
    - `output_frontend-worker` Web Worker，朔闰表、历书两个模块的前端调用入口

## 更新日誌

#### 2021-01-03

立項。

#### 2-23

內測上線。**2-24** 加入readme；加入評論；加入 GA；加入更新日誌。 
**2-26** 加入合朔日月赤度、節氣日赤度。
**2-28** 採用滾動數組，減少計算次數，重構數據結構，本地端速度提高 40%；前端相應調整，採用 Web Worker 多線程。避免 UI 與計算的衝突。今天突然發現望都不對，想了半天才發現，之前都是入曆日+1/2朔望月近點月之差，實際上應該是朔入曆+朔望月/2。
**3-02** 採用懶加載策略，只加載當前屏幕的信息。現在可以秒加載了，看來絕大部分時間都消耗在渲染上。魏晉時期的日月食基本完成。
**3-15** 增加日書、轉換tab。增加魏晉日書，轉換工具。

#### 其他已解決問題

兩個倉庫合併。npm run build 。ContinuedFrac' is not exported from '../src/Shangshu-calendar/convert_congruence-modulo'. 打包失敗。朔閏表疊在一起 ————四分短  長  增加唯一id，以前都是一個所以固定高度 03-28。公元年一年只顯示一次。這個文件的函數exports了， 如果我要在本文件中調用這個函數該怎麼辦？exports在文件末尾就可以。連分數latex跟調日法、大衍串在一起了。bug自己消失了。連分數增加i。調日法輸入，彈出來兩數不互質。曆法選項框初始値「請選擇曆法s」，不要讓下面的動。每個tab有不同的使用說明。不同的tab有不同的封面图，也就是不同的tab有不同的classname。分數latex怎麼放到灰色框天文部分的bind，相當於重複計算了4遍？2458849.5 儒略日 1月0日。乾象月緯隔幾天就我有一個消失。景初月赤緯不對，一正一負。紀元月赤經距離冬至超過一半就不行。丟失精度，算不出來：章法：把魏晉的全部過了一遍，興和、天保、甲寅、大象曆數字太大，超過達到20位？？不知道是不是因爲這個。但是天和就算得出。奇怪……看了下，和李銳調日法是否算得出沒有關係。分數的最小公倍數，lcmNumer。曆書：大衍、庚午的月亮跑不了——MoonLatiAccumList: [0, 0, 187, 358, 505, 620, 695, 722, 695, 620, 505, 358, 187]最後漏了一個0。天文的月亮，乾象、大明每次點都會縮小，中了魔咒一樣 ——變量名的問題。日書加上曆法名。日書月名沒有閏月。前兩日九宮亂入。宣明沒有黃道度

#### 4-21 公測上線

版本：核心 `0.90` 前端 `1.00`

#### 4-25 `0.91 1.01`

4 月 24 日本站編入 Google 索引 **核心** 增加時刻轉辰刻。日赤緯、日出公式曆法加上了日躔，至少紀元能跟論文合。授時明天還不對。訂正躔離：重新整理月離表的邊界；修改明天躔離；唐系日躔改用不等間距內插。宋志「紹興四年<n>1193</n>十二月<n>紀元</n>小餘七千六百八十，太史不進，故十一月小盡」。一個迷思：若索引從 1 開始，小餘 8285 左右，與大統相合，若索引從 0 開始，則是 7681，雖與引文相合，但與大統差了太多。我目前還是從 1 開始索引。修改定朔望小餘問題；修改定氣問題。 **前端** 調整文件結構：拆分時間板塊；拆分朔閏表板塊；加入曆書年份限制。

#### 4-29 `0.92 1.01.1`

 **核心** 天文模塊增加交食、交食週期與交點月換算。增加魏晋南北系、大業、戊寅、麟德、大衍交食。元嘉非常奇怪，原來的交會差，單算入交日的話跟其他曆都不一樣，但是最後結果是一樣的，迷惑。現在已有的食甚改正，有些方向都是相反的，奇怪。調整魏晉系閏餘單位，本來想把古六曆閏餘改成 19，發現顓頊不好改，放棄。增加 fraction.js。 **前端** 文件改名。升級依賴。辰刻轉換由文字換成表格。修改表格 css

#### 4-29 晚 `0.92.1 1.01.2`

 **核心** 修復四分曆跑不來的小問題：未把調用交食排除。調用交食模塊之前先用去交日篩選，大大節省算力。30 以內的阿拉伯數字轉漢字換成列表，能快一點；朔閏表月序改成漢字 **前端** 實現了``內 html 標籤：曆書九宮色添加背景色；朔閏表表頭增加樣式，交食進朔符號添加顏色

#### 5-02`0.93`

 **核心** 重要更新：重構躔離。此前一直用的 (日盈縮積 - 月遲疾積) / (分母) 來計算日月改正，發現並不是這麼回事，大部分曆法都能適用，但是崇玄、應天、儀天、崇天、統元、大衍、乾元這七部曆法的月行改正分母並不固定，算出來大衍的差距能達到 8 刻之巨，所以只好重新錄入所有曆法的朓朒積，再直接用招差術或拉格朗日內插計算。數據已根據陳美東的日躔月離表兩篇論文訂正<n>乾元陳美東843改成850，奇怪，「四十三」和「五十」怎麼會錯呢</n>。修改宣明、應天、儀天月離，此三曆較特殊，月離表分爲兩截，此前我都合爲一個。給所有曆法補上定氣積日表。大幅精簡天文模塊 bind 的代碼。入轉日、入氣日、入交日索引全部統一從 0 開始。修改望也進朔的小 bug。

#### 5-03`0.94 1.01.3`

 **核心** 增加所有曆法的沒滅。修復大衍交食，與頁 538 算例相合，完美可靠。修復曆書月名的小問題。曆書的候土卦從 0 索引，修正土卦相差一日的小問題。修復四分曆書沒有 13 個月的小問題。精簡一些寫法。 **前端** 小優化：節氣增加底色等

#### 5-05`0.95 1.01.4`

 **核心** 訂正天文曆：加入唐宋曆月行九道；調整結構，加上躔離、定交改正。修正乾象、大衍等月緯。日經、昏中爲夜半，日緯爲正午。變量改名。修復：唐系日躔340 日以上 NaN，訂正躔離亂七八糟的符號，現代擬合的小bug，優化魏晉南北系月離運算速度。整理月亮位置轉換<n>皇極大衍黃白差沒問題：黃道44，黃白差-1.47<n>頁60</n>，其他應該也沒什麼問題</n>。疏理黃赤轉換，補上宋曆黃轉赤反函數。增強會圓術，增強弧矢割圓，推廣到三角函數。 **前端** 調整曆書樣式

#### 5-09 `0.96 1.02`

**核心** 1、補出弧矢割圓赤轉黃，冥思苦想，畫了好幾種輔助線，最後得來全不費工夫；弧矢割圓加上了任意黃赤交角；訂正弧矢割圓緯度、日出；補上三角割圓赤轉黃；訂正三角割圓，修正球面三角的赤緯轉換，現在三角割圓總算與球面三角全等了。會圓術刪掉週天度和半徑的選項。2、加上授時月亮位置，太難了，結果依然不對。2、大調整，積度轉宿度模塊：Accum2Mansion取消統一計算，分散在各日中，要不然實在不好切。各曆朔閏表赤道日度、昏中星，天文曆日月度應該都差不多了。宋元昏中星尚不能確定，一般情況應該沒什麼問題；後漢四分昏中星跟表比起來，二至都是對的，其他時候少1度。每日月亮位置，<v>中</v>頁 514：大衍算法有問題，欽天以後都改用另外的算法，我統一用宋代算法。3、簡化寫法。增加一個分析日行改正誤差的小片段<n>沒放到前端</n>。 **前端** 重新用上react-markdown，把所有的<p className='note>全都移到md文件中，爲了方便翻譯。寫了一個下午文案，加上參考文獻，增加命名規範。

#### 5-10 `0.97`

**核心** 1、重寫土王、推卦，乾象景初用京氏，其餘用孟氏。增加「月在張心署之」。2、根據大衍曆議修改歲差：復原梁武大同歲差宿度；修復梁武大同跑不起來的問題；劉孝孫上元改為虛8。各曆朔閏表的赤度、昬中應該沒什麼問題了。3、大衍黃赤轉換改為和崇天一樣；公式晷長取消日躔。4、補充、重寫時辰轉換，徹底清楚了。5、增加所有曆法的進朔退望，圓夢了。6、一個系統性bug：閏月進退的NewmOrderRaw竟然一直用的平朔。7、清理朔閏表用不到的傳參，精簡變量；取消四分以後的大小餘。

#### 5-12 `0.98 1.03`

**核心** 1、增加四大三小提示。試了下大衍，四大情況非常常見，需要手動調整。2、天文曆修改月亮經度算法，應該不會差太多了。躔離計算增加月實行度。修改月行九道的判斷條件。修復半月離曆法的疏忽。3、增加積度宿度互換。4、修改天文常數精度。修復一個時辰轉換小疏忽。**前端** 1、網頁調整目錄結構：幾何搬到天文標籤。2、加個contributors wall

#### 5-14 `0.99`

**核心** 1、天文曆修改月亮經度算法，應該不會差太多了。2、重寫九道術、授時黃白轉換。授時依然有問題，太難了，只能先放著。3、修改九道對應小問題。修復四分曆書跑不起來

#### Todo list

##### 核心

- 訂正黃白轉換
- 交食
- 增加黃道過宮<n>不重要</n>
- 增加九服晷漏<n>不重要</n>
- 細化曆書的日神<n>不重要</n>
- 增乘開方術<n>不重要</n>
- 遙遙無期的五星計算

##### 前端

- 自動長曆功能
- 雙語支持
- 新的曆法選擇框

### Known bugs

##### 核心

- 明天入轉入交、觀天入交、統天入轉入交
- 庚午算不出曆書

##### 前端

- 在生成的時候就要把 css 移到前面
- 點command+c複製，會自己跑到最下面