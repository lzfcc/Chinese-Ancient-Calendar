## 琴律計算器

不好意思臨時借用一下曆法的網站，開一個琴律計算器。

`八度値 = log2(頻率比)`，`音分 = 1200 * 八度値`

三分損益律：向上是 *3/2，向下是 *2/3。A 是歸算在 1—2 個八度之間，B 是歸算在 0.5—1 個八度之間。

純律的 `+ - ` 表示多或少一個普通音差 22 音分。

### 減字譜轉唱名

- s 散音，f 泛音，l 連音（上滑下滑），zhuang 撞
- 【格式】類型,徽位,弦;
- 【備註】s 不需要徽位，l 不需要弦，zhuang 不需要徽位、弦
- 【調弦法】見上「調弦法」部分
- 【律制】1 準法律，2 徽法律。明清以來一般都是準法律
- 【宮弦】以幾弦爲宮音。正調以三弦爲宮
- 【宮弦頻率】現在標準是正調五弦 440hz，假設三弦爲宮，用「調弦法」算得準法律三弦是 64/81，三弦頻率就是 440 * 64/81 = 347.654321hz
- 【輸出模式】1 音名； 2 唱名；3 與宮弦的頻率比；4 頻率（以 hz 爲單位）
- 【顯示結果】৹ 泛音；◠ 連音；^ 撞；· 在左表示高一個八度，· 在右表示低一個八度；┴ ╧ 高一、兩個普通音差，┬ ╤ 低一、兩個普通音差，普通音差＝ 大全音 ﹣ 小全音 ＝ 81/80 = 21.5 音分。

示例是査阜西《洞庭》第一段。第一句 9.6 徽（b4），準確約值是 9.46（3）。

<img src="https://pic.imgdb.cn/item/6172d1262ab3f51d911ef6dd.png">

需要注意的是，徽位小分一般都是約值，程序歸算到了標準音位。

抓起、散音同聲暫時沒處理。

幽蘭開頭：`s,1;9.9,2;s,1;9.9,2;l,14;s,2;1;2;2;1;2;14,2;3;3;2;3;s,5;4;10,2;s,4;8,2;s,5;11,1;9,1;2;1;2;8,2;l,7.6;s,2;1;10,4`。裏面有個 \#4╤，比 4 高小半音（71 音分）。

第三段開頭泛音：`f,10,5;6;5;6;f,11,5;6;5;6;f,13,3;f,12,5;4;5;4;5;5;f,11,6;f,12,4;5;4;3;f,10,6;f,10,7;6;5;6;5;4;f,9,6;f,10,5;4;5;6;7;6;f,12,3;f,10,6;f,11,4;f,10,5;5;4;3;4;3;4;3;4;6;5;f,11,3;f,10,3,5;f,11,4;f,10,6;f,9,4;3;4;5;4;5;f,11,4;3;f,12,5;f,11,4;3;4;3;2;3;2;1;f,9,4;3;4;5;4;5`

幽蘭以一弦爲宮，若以三弦爲宮，則會出現五度律大五度。